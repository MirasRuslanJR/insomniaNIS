<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoChain - –ß–µ–ª–ª–µ–Ω–¥–∂–∏</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@700;900&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="../styles/custom.css">
    <link rel="stylesheet" href="../styles/challenges.css">
</head>
<body>
    <!-- nav -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <a href="./index.html" class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-green-600 to-green-800 rounded-full flex items-center justify-center">
                        <span class="text-white text-xl">üå±</span>
                    </div>
                    <span class="text-2xl font-bold text-gray-800">EcoChain</span>
                </a>
                <div class="flex items-center space-x-6">
                    <a href="./map.html" class="text-gray-700 hover:text-green-700">–ö–∞—Ä—Ç–∞</a>
                    <a href="./challenges.html" class="text-green-700 font-semibold">–ß–µ–ª–ª–µ–Ω–¥–∂–∏</a>
                    <a href="./verify.html" class="text-gray-700 hover:text-green-700">–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è</a>
                    <a href="./dashboard.html" class="text-gray-700 hover:text-green-700">–ü—Ä–æ—Ñ–∏–ª—å</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- hero -->
    <div class="bg-gradient-to-r from-green-600 to-green-800 text-white py-16">
        <div class="container mx-auto px-6 text-center">
            <h1 class="text-5xl font-bold mb-4">–†–∞–π–æ–Ω–Ω—ã–µ –ß–µ–ª–ª–µ–Ω–¥–∂–∏</h1>
            <p class="text-xl opacity-90 max-w-2xl mx-auto">
                –°–æ—Ä–µ–≤–Ω—É–π—Ç–µ—Å—å —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞–π–æ–Ω–∞–º–∏ –∏ –≤–Ω–æ—Å–∏—Ç–µ –∏–∑–º–µ—Ä–∏–º—ã–π –≤–∫–ª–∞–¥ –≤ —ç–∫–æ–ª–æ–≥–∏—é –≤–∞—à–µ–≥–æ –≥–æ—Ä–æ–¥–∞
            </p>
        </div>
    </div>

    <div class="container mx-auto px-6 py-12">
        <!-- filters -->
        <div class="bg-white rounded-2xl p-6 shadow-lg mb-8">
            <div class="flex flex-wrap items-center gap-4">
                <div>
                    <label class="block text-sm font-bold mb-2">–†–∞–π–æ–Ω</label>
                    <select id="districtFilter" class="px-4 py-2 border border-gray-300 rounded-lg">
                        <option value="all">–í—Å–µ —Ä–∞–π–æ–Ω—ã</option>
                        <!-- –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ DISTRICTS –≤ challenges.js -->
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-bold mb-2">–°—Ç–∞—Ç—É—Å</label>
                    <select id="statusFilter" class="px-4 py-2 border border-gray-300 rounded-lg">
                        <option value="all">–í—Å–µ</option>
                        <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                        <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option>
                    </select>
                </div>
                
                <div class="flex-1"></div>
                <div>
                    <label class="block text-sm font-bold mb-2">&nbsp;</label>
                    <button id="applyFilters" class="px-6 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700">
                        –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                    </button>
                </div>
            </div>
        </div>

        <!-- challenges grid -->
        <div id="challengesGrid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Loading -->
            <div class="col-span-full text-center py-12">
                <div class="animate-spin rounded-full h-12 w-12 border-4 border-green-500 border-t-transparent mx-auto"></div>
                <p class="mt-4 text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞ —á–µ–ª–ª–µ–Ω–¥–∂–µ–π...</p>
            </div>
        </div>

        <!-- create challenge (Admin) -->
        <div class="mt-12 text-center">
            <button id="createChallengeBtn" class="px-8 py-4 bg-blue-600 text-white rounded-xl font-bold text-lg hover:bg-blue-700 transition hidden">
                + –°–æ–∑–¥–∞—Ç—å —á–µ–ª–ª–µ–Ω–¥–∂
            </button>
        </div>
    </div>

    <!-- challenge details modal -->
    <div id="challengeModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-start mb-6">
                <h3 id="modalTitle" class="text-3xl font-bold text-gray-800"></h3>
                <button onclick="hideModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div id="modalContent"></div>
            
            <div class="mt-8 flex gap-4">
                <button onclick="hideModal()" class="flex-1 px-6 py-3 border-2 border-gray-300 rounded-lg font-semibold hover:bg-gray-50">
                    –ó–∞–∫—Ä—ã—Ç—å
                </button>
                <button id="joinChallengeBtn" class="flex-1 px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700">
                    –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è üöÄ
                </button>
            </div>
        </div>
    </div>


    <!-- create challenge modal (Admin only) -->
    <div id="createChallengeModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full max-h-[92vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">üèÜ –°–æ–∑–¥–∞—Ç—å —á–µ–ª–ª–µ–Ω–¥–∂</h3>
                <button onclick="hideCreateModal()" class="w-9 h-9 flex items-center justify-center rounded-full hover:bg-gray-100 text-gray-400 text-xl">‚úï</button>
            </div>
            <form id="createChallengeForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-bold mb-1">–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                    <input type="text" id="cTitle" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ß–∏—Å—Ç—ã–π –ú–µ–¥–µ—É" required>
                </div>
                <div>
                    <label class="block text-sm font-bold mb-1">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                    <textarea id="cDescription" rows="3" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ü–µ–ª–∏ —á–µ–ª–ª–µ–Ω–¥–∂–∞..." required></textarea>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-bold mb-1">–†–∞–π–æ–Ω *</label>
                        <select id="cDistrict" class="w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500">
                            <!-- –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ DISTRICTS –≤ challenges.js -->
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-1">–¢–∏–ø –¥–µ–π—Å—Ç–≤–∏—è *</label>
                        <select id="cActionType" class="w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500">
                            <option value="cleanup">üßπ –£–±–æ—Ä–∫–∞</option>
                            <option value="tree">üå≥ –î–µ—Ä–µ–≤—å—è</option>
                            <option value="recycle">‚ôªÔ∏è –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞</option>
                            <option value="bike">üö≤ –í–µ–ª–æ—Å–∏–ø–µ–¥</option>
                            <option value="water">üíß –í–æ–¥–∞</option>
                            <option value="energy">üí° –≠–Ω–µ—Ä–≥–∏—è</option>
                            <option value="education">üìö –ü—Ä–æ—Å–≤–µ—â–µ–Ω–∏–µ</option>
                            <option value="other">üå± –î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-bold mb-1">–¶–µ–ª—å (—á–∏—Å–ª–æ) *</label>
                        <input type="number" id="cGoal" class="w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 50" min="1" required>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-1">–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è</label>
                        <input type="text" id="cUnit" class="w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500" placeholder="–¥–µ–π—Å—Ç–≤–∏–π / –∫–≥ / –¥–µ—Ä–µ–≤—å–µ–≤">
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-bold mb-1">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ *</label>
                        <input type="date" id="cStartDate" class="w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500" required>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-1">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è *</label>
                        <input type="date" id="cEndDate" class="w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500" required>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-bold mb-1">–ù–∞–≥—Ä–∞–¥–∞</label>
                    <input type="text" id="cReward" class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 500 EcoPoints + –∑–Ω–∞—á–æ–∫ '–≠–∫–æ-—á–µ–º–ø–∏–æ–Ω'">
                </div>
                <div class="flex gap-3 pt-2">
                    <button type="button" onclick="hideCreateModal()" class="flex-1 py-2.5 border-2 border-gray-300 rounded-lg font-semibold hover:bg-gray-50 transition">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="flex-1 py-2.5 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition">
                        –°–æ–∑–¥–∞—Ç—å üèÜ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script type="module" src="../js/firebase-config.js"></script>
    <script type="module" src="../js/auth.js"></script>
    <script type="module" src="../js/challenges.js"></script>
    <script>
        AOS.init({ duration: 600, once: true });
    </script>
</body>
</html>